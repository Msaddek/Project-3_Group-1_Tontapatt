<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui" xmlns:b="http://bootsfaces.net/ui">

<ui:composition template="WEB-INF/template/userOffersTemplate.xhtml">

	<ui:define name="head">
		<title>Ajouter une offre</title>
	</ui:define>

	<ui:define name="content">

		<div class="page-wrapper bg-blue p-t-100 p-b-100 font-robo">
			<div class="wrapper wrapper--w680">
				<div class="card card-1">
					<div class="card-heading"></div>
					<div class="card-body">
						<h2 class="title">Inscription</h2>
						<b:form id="offerCreationForm">
							<div>
								<br /> <label for="inpName">Nom de l'offre:</label>
								<p:inputText id="inpName" value="#{mbShearingOffer.name}"
									placeholder="Nom de l'offre" required="true"
									requiredMessage="Vous devez entrer le nom de l'offre">
									<f:ajax update="inpName" />
									<f:ajax update="nameMessage" />
								</p:inputText>
								<p:message id="nameMessage" for="inpName" />
							</div>

							<div>
								<label for="inpStartDate">Date de début :</label>
								<p:calendar id="inpStartDate"
									value="#{mbShearingOffer.startDate}" showIcon="true"
									placeholder="__/__/____" required="true"
									requiredMessage="La date de début est requise"
									monthNavigator="true" yearNavigator="true" navigator="true"
									pattern="dd/MM/yyyy" mindate="#{mbDate.minimumOfferStartDate}">
									<p:ajax event="dateSelect" update="inpStartDate" />
									<p:ajax event="dateSelect" update="startDateMessage" />
									<p:ajax event="dateSelect"
										listener="#{mbDate.minimumOfferEndDate(mbShearingOffer.startDate)}"
										update="inpEndDate" />
								</p:calendar>
								<p:message id="startDateMessage" for="inpStartDate" />
							</div>
							<div>
								<label for="inpEndDate">Date de fin :</label>
								<p:calendar id="inpEndDate" value="#{mbShearingOffer.endDate}"
									showIcon="true" placeholder="__/__/____" required="true"
									requiredMessage="La date de fin est requise"
									monthNavigator="true" yearNavigator="true" navigator="true"
									pattern="dd/MM/yyyy" mindate="#{mbDate.minimumOfferEndDate}">
									<p:ajax event="dateSelect" update="inpEndDate" />
									<p:ajax event="dateSelect" update="endDateMessage" />
								</p:calendar>
								<p:message id="endDateMessage" for="inpEndDate" />
							</div>

							<div>
								<label for="inpAdresse">Adresse du troupeau :</label>
								<p:inputText id="inpAdresse" value="#{mbShearingOffer.address}"
									required="true" requiredMessage="Vous devez entrer une adresse"
									placeholder="Numéro et nom de rue">
									<p:ajax update="inpAdresse" />
									<p:ajax update="adresseMessage" />
								</p:inputText>
								<p:message id="adresseMessage" for="inpAdresse" />
							</div>

							<div class="codeCity">
								<div class="row row-space">
									<div class="col-2">
										<div>
											<label for="inpZipCode">Code postal :</label>
											<p:inputText id="inpZipCode" value="#{mbZipCodeCity.zipCode}"
												required="true" requiredMessage="Le code postal est requis"
												validatorMessage="Le code postal n'est pas valide"
												placeholder="Code postal *">
												<f:validateRegex
													pattern="^((0[1-9])|([1-8][0-9])|(9[0-8])|(2A)|(2B))[0-9]{3}$" />
												<p:ajax listener="#{mbZipCodeCity.onZipCodeChange()}"
													update="inpCity" />
												<p:ajax update="inpZipCode" />
												<p:ajax update="zipCodeMessage" />
											</p:inputText>
											<p:message id="zipCodeMessage" for="inpZipCode" />
										</div>
									</div>
									<div class="col-2">
										<div>
											<label for="inpCity">Ville :</label><br />
											<p:selectOneMenu id="inpCity" value="#{mbShearingOffer.city}"
												required="true"
												requiredMessage="Vous devez choisir une ville"
												converter="entityConverter">
												<f:selectItem itemLabel="Choisissez une ville" itemValue="" />
												<f:selectItems value="#{mbZipCodeCity.cities}" var="city"
													itemLabel="#{city.name}" itemValue="#{city}" />
												<p:ajax update="inpCity" />
												<p:ajax update="cityMessage" />
											</p:selectOneMenu>
											<p:message id="cityMessage" for="inpCity" />
										</div>
									</div>
								</div>
							</div>

							<div class="codeCity">
								<div class="row row-space">
									<div class="col-2">
										<div>
											<label for="inpSpecies">Espèce du troupeau :</label>
											<p:selectOneMenu id="inpSpecies" value="#{mbRace.species}"
												required="true"
												requiredMessage="Vous devez choisir une espèce"
												converter="entityConverter">
												<f:selectItem itemLabel="Choisissez une espece" itemValue="" />
												<f:selectItems value="#{mbSpecies.allSpecies()}"
													var="species" itemLabel="#{species.species}"
													itemValue="#{species}" />
												<p:ajax listener="#{mbRace.onSpeciesChange()}"
													update="inpRace" />
												<p:ajax update="inpSpecies" />
												<p:ajax update="speciesMessage" />
												<p:ajax update="raceMessage" />
											</p:selectOneMenu>
											<p:message id="speciesMessage" for="inpSpecies" />
										</div>
									</div>
									<div class="col-2">
										<div>
											<label for="inpRace">Race du troupeau :</label><br />
											<p:selectOneMenu id="inpRace" value="#{mbShearingOffer.race}"
												required="true"
												requiredMessage="Vous devez choisir une race"
												converter="entityConverter">
												<f:selectItem itemLabel="Choisissez une race" itemValue="" />
												<f:selectItems value="#{mbRace.races}" var="race"
													itemLabel="#{race.race}" itemValue="#{race}" />
												<p:ajax update="inpRace" />
												<p:ajax update="raceMessage" />
											</p:selectOneMenu>
											<p:message id="raceMessage" for="inpRace" />
										</div>
									</div>
								</div>
							</div>

							<div>
								<label for="inpAnimalCount">Nombre d'animaux dans le
									troupeau :</label>
								<p:inputNumber id="inpAnimalCount"
									value="#{mbShearingOffer.animalCount}" required="true"
									requiredMessage="Il faut entrer le nombre d'animaux"
									validatorMessage="Le nombre doit être un nombre entier positif"
									decimalPlaces="0" symbolPosition="s" minValue="0" />
								<p:message id="animalCountMessage" for="inpAnimalCount" />
							</div>

							<div>
								<label for="inpAnimalDailyPrice">Prix journalier d'un
									animal :</label>
								<p:inputNumber id="inpAnimalDailyPrice"
									value="#{mbShearingOffer.animalDailyPrice}" required="true"
									requiredMessage="Il faut entrer un prix"
									validatorMessage="Le nombre doit être un nombre positif"
									decimalPlaces="2" symbol=" €" symbolPosition="s" minValue="0" />
								<p:message id="animalDailyPriceMessage"
									for="inpAnimalDailyPrice" />
							</div>

							<div>
								<label for="inpMaxDist">Distance maximale à parcourir :</label>
								<p:inputNumber id="inpMaxDist"
									value="#{mbShearingOffer.maxTravelDistance}" required="true"
									requiredMessage="Il faut entrer la distance maximal que vous pouvez parcourir"
									validatorMessage="La distance doit être un nombre entier"
									decimalPlaces="0" symbol=" km" symbolPosition="s" minValue="0" />
								<p:message id="maxDistMessage" for="inpMaxDist" />
							</div>

							<div>
								<label for="inpDescription">Description :</label>
								<h:inputTextarea id="inpDescription" required="true"
									requiredMessage="Vous devez entrer la description de votre offre"
									value="#{mbShearingOffer.description}" rows="5" cols="30"
									counter="display" maxlength="255"
									counterTemplate="{0} caractères restants." autoResize="false" />
							</div>

							<div>
								<p:fileUpload id="inpPhoto1"
									label="Ajouter la première photo du troupeau :" mode="advanced"
									listener="#{mbShearingOffer.uploadPhoto}" required="true"
									requiredMessage="Vous devez télécharger une photo de votre troupeau"
									allowTypes="/(\.|\/)(gif|jpe?g|png)$/" fileLimit="1"
									fileLimitMessage="Vous avez le droit à une photos"
									invalidFileMessage="Le fichier doit être de type gif, jpe, jpeg ou png"
									uploadLabel="Télécharger" cancelLabel="Annuler"
									update="photoMessage1" />
								<p:message id="photoMessage1" for="inpPhoto1" />
							</div>
							
							<div>
								<p:fileUpload id="inpPhoto2"
									label="Ajouter la deuxième photo du troupeau :" mode="advanced"
									listener="#{mbShearingOffer.uploadPhoto}" required="true"
									requiredMessage="Vous devez télécharger une photo de votre troupeau"
									allowTypes="/(\.|\/)(gif|jpe?g|png)$/" fileLimit="1"
									fileLimitMessage="Vous avez le droit à une photos"
									invalidFileMessage="Le fichier doit être de type gif, jpe, jpeg ou png"
									uploadLabel="Télécharger" cancelLabel="Annuler"
									update="photoMessage2" />
								<p:message id="photoMessage2" for="inpPhoto2" />
							</div>
							<div>
								<p:fileUpload id="inpPhoto3"
									label="Ajouter la troisième photo du troupeau :" mode="advanced"
									listener="#{mbShearingOffer.uploadPhoto}" required="true"
									requiredMessage="Vous devez télécharger une photo de votre troupeau"
									allowTypes="/(\.|\/)(gif|jpe?g|png)$/" fileLimit="1"
									fileLimitMessage="Vous avez le droit à une photos"
									invalidFileMessage="Le fichier doit être de type gif, jpe, jpeg ou png"
									uploadLabel="Télécharger" cancelLabel="Annuler"
									update="photoMessage3" />
								<p:message id="photoMessage3" for="inpPhoto3" />
							</div>
							<div>
								<p:fileUpload id="inpPhoto4"
									label="Ajouter la quatrième photo du troupeau :" mode="advanced"
									listener="#{mbShearingOffer.uploadPhoto}" required="true"
									requiredMessage="Vous devez télécharger une photo de votre troupeau"
									allowTypes="/(\.|\/)(gif|jpe?g|png)$/" fileLimit="1"
									fileLimitMessage="Vous avez le droit à une photos"
									invalidFileMessage="Le fichier doit être de type gif, jpe, jpeg ou png"
									uploadLabel="Télécharger" cancelLabel="Annuler"
									update="photoMessage4" />
								<p:message id="photoMessage4" for="inpPhoto4" />
							</div>
							


							<div class="p-t-20">
								<b:commandButton class="btnSubscription" value="Valider"
									action="#{mbShearingOffer.createOffer()}" />
							</div>
						</b:form>
					</div>
				</div>
			</div>
		</div>

	</ui:define>

</ui:composition>

</html>